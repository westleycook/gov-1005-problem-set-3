---
title: "Problem Set 3"
author: "Westley Cook"
date: "2/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(reprex)
library(janitor)
library(gt)

```

```{r read_in_data, include=FALSE}

xian <- read_csv("./raw-data/xian_data.csv",
                 skip = 3,
                 na = "undefined") %>% 
  clean_names()
  

# Used glimpse() and summary() to look at the data


```

## Madlibs

```{r mad-lib-1, include=FALSE}

treatment_respondents <- xian %>% 
  filter(treatment == 1) %>% 
  count() %>% 
  pull(n)

```

1. **`r treatment_respondents`** respondents are in the treatment group.

```{r mad-lib-2, include=FALSE}


gov_avg_rating_in_treatment_group <- xian %>% 
  filter(treatment == 1) %>% 
  summarize(gov_avg_in_treatment_group = mean(eval_gov_overall, na.rm = TRUE)) %>% 
  pull(gov_avg_in_treatment_group)

```

2. Among respondents from the treatment group, the government has an average **`r gov_avg_rating_in_treatment_group`**
rating.

```{r mad-lib-3, include=FALSE}

most_common_traffic <- xian %>% 
  count(eval_gov_traffic) %>% 
  arrange(desc(n)) %>% 
  slice(1) %>% 
  pull(eval_gov_traffic)

```

3. The most common rating for the government’s handling of traffic is **`r most_common_traffic`**.

```{r mad-lib-4, include=FALSE}

any_10_count <- xian %>% 
  filter(eval_gov_overall == 10 |
         eval_gov_demo == 10 |
         eval_gov_traffic == 10) %>% 
  count() %>% 
  pull(n)

```

4. **`r any_10_count`** respondents have given the government a 10 rating overall or on demolitions
or on traffic.

```{r mad-lib-5, include=FALSE}

all_10s <- xian %>% 
  filter(eval_gov_overall == 10,
         eval_gov_demo == 10,
         eval_gov_traffic == 10) %>% 
  count() %>% 
  pull(n)

```

5. But only **`r all_10s`** gave the government a 10 rating overall and on demolitions and on
traffic.

```{r mad-lib-6, include=FALSE}

tv_respondents <- xian %>% 
  filter(str_detect(news_source, "A")) %>% 
  count() %>% 
  pull(n)

```

6. The number of respondents who get their news from Television is **`r tv_respondents`**.

```{r mad-lib-7, include=FALSE}

square_locations <- xian %>% 
  filter(str_detect(location, "square")) %>% 
  slice(1, 4) %>% 
  pull(location)

```

7. Of the 4 different locations where the respondents were surveyed, the
following two locations end with “square”: **`r square_locations`**
